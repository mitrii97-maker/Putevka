<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>–≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä</title>
<style>
  :root {
    --bg: radial-gradient(circle at 50% 120%, #0a0a1f, #000000);
    --glass: rgba(255, 255, 255, 0.06);
    --glass-strong: rgba(255, 255, 255, 0.12);
    --border: rgba(255, 255, 255, 0.1);
    --text: #ffffff;
    --text-dim: rgba(255, 255, 255, 0.65);
    --blue: #007aff;
    --green: #30d158;
    --red: #ff453a;
    --orange: #ff9f0a;
  }

  * { margin:0; padding:0; box-sizing:border-box; }
  html, body {
    height: 100dvh;
    overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    background: var(--bg);
    color: var(--text);
    background-attachment: fixed;
  }

  body {
    display: flex;
    flex-direction: column;
    padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
  }

  .blur-bg {
    position: fixed;
    inset: 0;
    background: var(--bg);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    z-index: -2;
  }

  header {
    text-align: center;
    padding: 60px 20px 30px;
    font-size: 48px;
    font-weight: 900;
    letter-spacing: -1px;
    background: linear-gradient(90deg, #007aff, #00ff88);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .glass-card {
    margin: 20px;
    padding: 28px;
    background: var(--glass);
    border-radius: 28px;
    border: 1px solid var(--border);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    box-shadow: 
      0 20px 40px rgba(0,0,0,0.4),
      inset 0 1px 0 rgba(255,255,255,0.2);
  }

  .progress-label {
    display: flex;
    justify-content: space-between;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-dim);
    margin-bottom: 12px;
  }

  #plan-input {
    width: 100%;
    padding: 16px;
    font-size: 48px;
    font-weight: 900;
    text-align: center;
    background: var(--glass-strong);
    border: 1px solid var(--border);
    border-radius: 20px;
    color: var(--text);
    margin-bottom: 20px;
  }

  .progress-container {
    height: 16px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    overflow: hidden;
    margin: 20px 0;
  }

  .progress {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #007aff 0%, #30d158 70%, #ff9f0a 100%);
    border-radius: 8px;
    transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 0 20px rgba(0, 122, 255, 0.6);
  }

  .overshoot-text {
    text-align: center;
    font-size: 36px;
    font-weight: 900;
    color: var(--orange);
    text-shadow: 0 0 20px rgba(255, 159, 10, 0.5);
    opacity: 0;
    transition: opacity 0.5s;
  }

  .trucks {
    padding: 0 20px 120px;
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .truck {
    {
    background: var(--glass);
    border-radius: 24px;
    padding: 22px;
    display: flex;
    align-items: center;
    border: 1px solid var(--border);
    backdrop-filter: blur(20px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }

  .num {
    font-size: 36px;
    font-weight: 900;
    width: 100px;
    text-align: center;
  }

  .count {
    font-size: 64px;
    font-weight: 900;
    min-width: 140px;
    text-align: center;
    text-shadow: 0 0 30px rgba(255,255,255,0.3);
  }

  .volume {
    margin-left: auto;
    font-size: 28px;
    font-weight: 700;
    color: var(--text-dim);
  }

  .btn {
    width: 80px;
    height: 80px;
    border-radius: 40px;
    border: none;
    font-size: 44px;
    font-weight: bold;
    color: white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    transition: all 0.2s;
  }

  .btn.plus { background: linear-gradient(135deg, #007aff, #00d4ff); }
  .btn.minus { background: linear-gradient(135deg, #ff453a, #ff9f0a); }

  .btn:active {
    transform: scale(0.9);
  }

  .fab {
    position: fixed;
    bottom: max(30px, env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    padding: 22px 60px;
    font-size: 24px;
    font-weight: 800;
    background: linear-gradient(135deg, #30d158, #00ff88);
    color: black;
    border: none;
    border-radius: 60px;
    box-shadow: 0 15px 40px rgba(48, 209, 88, 0.6);
    z-index: 999;
  }

  .add-bar {
    position: fixed;
    bottom: max(100px, env(safe-area-inset-bottom) + 70px);
    left: 20px;
    right: 20px;
    display: flex;
    gap: 12px;
    z-index: 998;
  }

  .add-bar input {
    flex: 1;
    padding: 20px;
    font-size: 28px;
    text-align: center;
    background: var(--glass-strong);
    border: 1px solid var(--border);
    border-radius: 24px;
    color: white;
  }

  .add-bar button {
    padding: 20px 32px;
    background: var(--blue);
    border-radius: 24px;
    font-size: 20px;
    font-weight: 700;
  }
</style>
</head>
<body>

<div class="blur-bg"></div>

<header>–≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä</header>

<div class="glass-card">
  <div class="progress-label">
    <span>–ù–∞—Ä—è–¥ –Ω–∞ —Å–º–µ–Ω—É</span>
    <span id="stats">0 / 3000 –º¬≥</span>
  </div>
  <input type="number" id="plan-input" value="3000">
  <div class="progress-container"><div class="progress" id="bar"></div></div>
  <div class="overshoot-text" id="over">+0 –º¬≥ üî•</div>
</div>

<div class="trucks" id="list"></div>

<div class="add-bar">
  <input type="text" id="new-num" placeholder="–ù–æ–º–µ—Ä" maxlength="5">
  <button onclick="add()">+ –ë–µ–ª–ê–ó</button>
</div>

<button class="fab" onclick="copy()">–î–∏—Å–ø–µ—Ç—á–µ—Ä—É</button>

<script>
  const V = 37.8;
  let trucks = JSON.parse(localStorage.getItem('liq26')) || [];
  let target = +localStorage.getItem('liq26_target') || 3000;

  document.getElementById('plan-input').value = target;

  function save() {
    localStorage.setItem('liq26', JSON.stringify(trucks));
    localStorage.setItem('liq26_target', target);
  }

  function update() {
    const total = trucks.reduce((s,t) => s + t.c * V, 0);
    const p = Math.min((total/target)*100, 200);
    document.getElementById('bar').style.width = p + '%';
    document.getElementById('stats').textContent = `${Math.round(total).toLocaleString()} / ${target.toLocaleString()} –º¬≥`;

    const overEl = document.getElementById('over');
    if (total > target) {
      overEl.textContent = `+${Math.round(total-target).toLocaleString()} –º¬≥ üî•`;
      overEl.style.opacity = 1;
    } else {
      overEl.style.opacity = 0;
    }
  }

  function render() {
    const list = document.getElementById('list');
    list.innerHTML = trucks.map((t, i) => `
      <div class="truck">
        <div class="num">${t.n}</div>
        <button class="btn minus" onclick="ch(${i},-1)">‚Äì</button>
        <div class="count">${t.c}</div>
        <button class="btn plus" onclick="ch(${i},1)">+</button>
        <div class="volume">${(t.c * V).toFixed(1)} –º¬≥</div>
      </div>
    `).join('');
    update();
  }

  }

  window.ch = (i, d) => {
    trucks[i].c = Math.max(0, trucks[i].c + d);
    save();
    render();
    navigator.vibrate?.(40);
  }

  window.add = () => {
    const num = document.getElementById('new-num').value.trim().toUpperCase();
    if (!num) return;
    if (trucks.some(t => t.n === num)) return alert('–£–∂–µ –µ—Å—Ç—å');
    trucks.push({n: num, c: 0});
    document.getElementById('new-num').value = '';
    save();
    render();
  }

  document.getElementById('plan-input').onchange = e => {
    target = Math.max(100, +e.target.value || 3000);
    save();
    update();
  };

  window.copy = () => {
    const text = trucks
      .filter(t => t.c > 0)
      .map(t => `${t.n} ‚Äî ${t.c} —Ä–µ–π—Å${t.c === 1 ? '' : '–∞'}`)
      .join('\n') || '–ù–æ–ª—å —Ä–µ–π—Å–æ–≤';
    navigator.clipboard.writeText(text);
    const b = document.querySelector('.fab');
    b.textContent = '–ì–æ—Ç–æ–≤–æ!';
    b.style.background = '#30d158';
    setTimeout(() => {
      b.textContent = '–î–∏—Å–ø–µ—Ç—á–µ—Ä—É';
      b.style.background = 'linear-gradient(135deg, #30d158, #00ff88)';
    }, 2000);
  };

  document.getElementById('new-num').addEventListener('keydown', e => e.key === 'Enter' && add());

  render();
</script>
</body>
</html>
