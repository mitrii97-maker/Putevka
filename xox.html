<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ –¥–ª—è –Ω–∞—Å ‚ù§Ô∏è</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, set, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // ‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê
    // –í–°–¢–ê–í–¨ –°–í–û–ô –ù–û–í–´–ô –ö–û–ù–§–ò–ì –°–Æ–î–ê
  const firebaseConfig = {
  apiKey: "AIzaSyAzGea6sRTQek_bYAOnJdvKjKxd5sRgX7E",
  authDomain: "klicker-love.firebaseapp.com",
  databaseURL: "https://klicker-love-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "klicker-love",
  storageBucket: "klicker-love.firebasestorage.app",
  messagingSenderId: "805841292732",
  appId: "1:805841292732:web:8bfbe94ddbe6ac7b472fb9",
  measurementId: "G-L1H4GM9FQ8"
};
    // ‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const gameRef = ref(db, "xo_game_2025");

    let mySymbol = null;

    // –°–±—Ä–æ—Å –∏–≥—Ä—ã
    if (location.hash === "#reset") {
      remove(gameRef);
      location.hash = "";
      location.reload();
    }

    onValue(gameRef, (snap) => {
      const data = snap.val();

      // –ï—Å–ª–∏ –∏–≥—Ä—ã –Ω–µ—Ç ‚Äî –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ —Å–æ–∑–¥–∞—ë—Ç –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫—Ä–µ—Å—Ç–∏–∫–∞–º–∏
      if (!data) {
        set(gameRef, { board: Array(9).fill(null), turn: "X" });
        mySymbol = "X";
        document.getElementById("status").textContent = "–¢—ã –∫—Ä–µ—Å—Ç–∏–∫–∏ ‚úï ¬∑ –¢–≤–æ–π —Ö–æ–¥!";
        return;
      }

      // –ò–≥—Ä–∞ –µ—Å—Ç—å
      document.getElementById("board").style.display = "grid";

      // –í—Ç–æ—Ä–æ–π –∏–≥—Ä–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ–ª–∏–∫–∏
      if (!mySymbol) {
        mySymbol = "O";
        document.getElementById("status").textContent = data.turn === "O" ? "–¢–≤–æ–π —Ö–æ–¥! ‚óØ" : "–ñ–¥—ë–º —Ö–æ–¥ –∫—Ä–µ—Å—Ç–∏–∫–æ–≤...";
      }

      render(data.board);
      updateStatus(data);
    });

    function move(i) {
      if (mySymbol !== getTurn()) return;
      set(gameRef, {
        board: getBoard().map((c, idx) => idx === i ? mySymbol : c),
        turn: mySymbol === "X" ? "O" : "X"
      });
    }

    function getBoard() {
      const snap = document.querySelectorAll(".cell");
      return Array.from(snap).map(el => el.dataset.value || null);
    }

    function getTurn() {
      const turn = document.getElementById("status").textContent.includes("‚óØ") ? "O" : "X";
      return turn;
    }

    function render(board) {
      board.forEach((val, i) => {
        const cell = document.getElementById("c" + i);
        if (val && cell.dataset.value !== val) {
          cell.dataset.value = val;
          cell.innerHTML = val === "X" ? "‚úï" : "‚óØ";
          cell.classList.add(val === "X" ? "x" : "o");
        }
      });
    }

    function updateStatus(data) {
      const win = checkWin(data.board);
      if (win) {
        document.getElementById("status").textContent = win === "draw" 
          ? "ü§ù –ù–∏—á—å—è! –í—ã –∏–¥–µ–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞ ‚ù§Ô∏è" 
          : win === mySymbol 
            ? "üéâ –¢—ã –ü–û–ë–ï–î–ò–õ(–ê)!!!" 
            : "ü•π –¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª(–∞)... –Ω–æ —è —Ç–µ–±—è –ª—é–±–ª—é ‚ù§Ô∏è";
      } else {
        document.getElementById("status").textContent = data.turn === mySymbol 
          ? "–¢–í–û–ô –•–û–î!" 
          : "–•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...";
      }
    }

    function checkWin(b) {
      const lines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      for (let l of lines) if (b[l[0]] && b[l[0]] === b[l[1]] && b[l[0]] === b[l[2]]) return b[l[0]];
      if (b.every(c => c)) return "draw";
      return null;
    }

    document.querySelectorAll(".cell").forEach((c, i) => c.onclick = () => move(i));
    document.getElementById("reset").onclick = () => { remove(gameRef); location.reload(); };
  </script>

  <style>
    body{margin:0;height:100dvh;background:#000;color:#fff;font-family:-apple-system,system-ui;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .container{max-width:420px;width:92vw;background:rgba(30,30,40,0.65);backdrop-filter:blur(30px);border-radius:38px;border:1px solid rgba(255,255,255,0.1);box-shadow:0 30px 80px rgba(0,0,0,0.6);padding:40px 20px;text-align:center;position:relative}
    h1{font-size:36px;margin:0 0 15px;background:linear-gradient(90deg,#ff6bcd,#7b61ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    #board{display:none;grid-template-columns:repeat(3,1fr);gap:16px;margin:50px auto}
    .cell{width:100px;height:100px;background:rgba(255,255,255,0.06);border-radius:28px;display:flex;align-items:center;justify-content:center;font-size:72px;cursor:pointer;transition:.3s;user-select:none}
    .cell:hover{background:rgba(255,255,255,0.15);transform:scale(1.06)}
    .x{color:#ff6bcd;animation:x 0.5s}
    .o{color:#7b61ff;animation:o 0.5s}
    @keyframes x{from{transform:scale(0) rotate(45deg)}to{transform:scale(1) rotate(0)}}
    @keyframes o{from{transform:scale(0)}to{transform:scale(1)}}
    #status{font-size:26px;font-weight:600;margin:20px 0;min-height:60px}
    button{background:linear-gradient(135deg,rgba(255,107,203,0.3),rgba(123,97,255,0.3));border:none;border-radius:26px;padding:16px 40px;color:#fff;font-size:19px;cursor:pointer;margin-top:20px;transition:.3s;border:1px solid rgba(255,255,255,0.15)}
    button:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(123,97,255,0.4)}
    .heart{color:#ff6bcd;animation:beat 1.5s infinite}
    @keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.35)}}
  </style>
</head>
<body>
  <div class="container">
    <h1>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ <span class="heart">‚ù§Ô∏è</span></h1>
    <div id="board">
      <div class="cell" id="c0"></div>
      <div class="cell" id="c1"></div>
      <div class="cell" id="c2"></div>
      <div class="cell" id="c3"></div>
      <div class="cell" id="c4"></div>
      <div class="cell" id="c5"></div>
      <div class="cell" id="c6"></div>
      <div class="cell" id="c7"></div>
      <div class="cell" id="c8"></div>
    </div>
    <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <button id="reset">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    <p style="margin-top:30px;font-size:14px;opacity:0.6">–°–±—Ä–æ—Å: –¥–æ–±–∞–≤–∏—Ç—å #reset –≤ —Å—Å—ã–ª–∫—É</p>
  </div>
</body>
</html>
