<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ü—Ä–∞–≤–¥–∞ –∏–ª–∏ –î–µ–π—Å—Ç–≤–∏–µ ‚ù§Ô∏è</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    body {font-family: Arial; text-align:center; background: linear-gradient(135deg, #ff6b6b, #ffb3b3); color:white; min-height:100vh; margin:0; padding:20px;}
    h1 {font-size:2.5em; margin:20px;}
    #question {font-size:1.8em; padding:30px; background:rgba(255,255,255,0.2); border-radius:20px; margin:30px; min-height:120px;}
    button {padding:20px 40px; margin:20px; font-size:1.5em; background:#fff; color:#ff6b6b; border:none; border-radius:50px; cursor:pointer;}
    button:hover {transform:scale(1.1);}
    #link {margin:30px; padding:20px; background:rgba(255,255,255,0.3); border-radius:15px; word-break:break-all;}
  </style>
</head>
<body>
  <h1>–ü—Ä–∞–≤–¥–∞ –∏–ª–∏ –î–µ–π—Å—Ç–≤–∏–µ? ‚ù§Ô∏è</h1>
  <div id="link">–û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –ª—é–±–∏–º–æ–π:<br><b id="url"></b></div>
  <div id="question">–ñ–¥—ë–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...</div>
  <button onclick="choose('truth')">–ü—Ä–∞–≤–¥–∞ üî•</button>
  <button onclick="choose('dare')">–î–µ–π—Å—Ç–≤–∏–µ üòà</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDS3YUcSW26NDSJJAxbvQdJDwHTpUN-k5A",
      authDomain: "xox-gamelove.firebaseapp.com",
      databaseURL: "https://xox-gamelove-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "xox-gamelove",
      storageBucket: "xox-gamelove.firebasestorage.app",
      messagingSenderId: "99410167270",
      appId: "1:99410167270:web:c44b4f7f22a88a2db34227"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let roomId = new URLSearchParams(location.search).get('r') || Date.now().toString(36);
    if (!location.search) history.replaceState(null,null,'?r='+roomId);
    document.getElementById('url').textContent = location.href;

    const room = db.ref('love-rooms/'+roomId);
    const turn = room.child('turn'); // X –∏–ª–∏ O
    const choice = room.child('choice'); // truth / dare
    const question = room.child('question');

    let me = null;

    room.child('players').transaction(c=>(c||0)+1, (_,__,snap)=>{
      const count = snap.val();
      me = count===1 ? 'X' : 'O';
      document.getElementById('question').innerHTML = me==='X' ? '–¢—ã –Ω–∞—á–∏–Ω–∞–µ—à—å! –í—ã–±–µ—Ä–∏ üëá' : '–ñ–¥—ë–º, –∫–æ–≥–¥–∞ –ª—é–±–∏–º—ã–π –≤—ã–±–µ—Ä–µ—Ç...';
    });

    function choose(type) {
      if (me !== turn.val() && turn.val() !== null) return alert('–°–µ–π—á–∞—Å –Ω–µ —Ç–≤–æ–π —Ö–æ–¥!');
      choice.set(type);
      turn.set(me==='X'?'O':'X');
      document.getElementById('question').textContent = '–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≥–æ—Ä—è—á–∏–π –≤–æ–ø—Ä–æ—Å...';
    }

    choice.on('value', snap=>{
      if (!snap.val()) return;
      const truths = ["–°–∞–º–æ–µ –∏–Ω—Ç–∏–º–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ —Ç—ã –∑–∞–Ω–∏–º–∞–ª—Å—è —Å–µ–∫—Å–æ–º?","–ö–∞–∫–æ–π —É —Ç–µ–±—è —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —Ñ–µ—Ç–∏—à?","–°–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –±—ã–ª–æ —É —Ç–µ–±—è –¥–æ –º–µ–Ω—è?","–ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤ –ø–æ—Å—Ç–µ–ª–∏, –Ω–æ —Å—Ç–µ—Å–Ω—è–µ—à—å—Å—è —Å–∫–∞–∑–∞—Ç—å?","–û–ø–∏—à–∏ —Å–≤–æ–π —Å–∞–º—ã–π –∂–∞—Ä–∫–∏–π —Å–æ–Ω –ø—Ä–æ –º–µ–Ω—è","–ö–∞–∫ —á–∞—Å—Ç–æ —Ç—ã –º–∞—Å—Ç—É—Ä–±–∏—Ä—É–µ—à—å –¥—É–º–∞—è –æ–±–æ –º–Ω–µ?"];
      const dares = ["–°–Ω–∏–º–∏ –æ–¥–Ω—É –≤–µ—â—å —Å —Å–µ–±—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å","–ü–æ—Ü–µ–ª—É–π —ç–∫—Ä–∞–Ω —Ç—É–¥–∞, –≥–¥–µ —Ö–æ—á–µ—à—å –º–µ–Ω—è –ø–æ—Ü–µ–ª–æ–≤–∞—Ç—å","–°–¥–µ–ª–∞–π —Å—Ç–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –∏–∑–¥–∞—ë—à—å –≤ –ø–æ—Å—Ç–µ–ª–∏","–ü–æ–∫–∞–∂–∏ —Å–≤–æ—ë –ª—é–±–∏–º–æ–µ –±–µ–ª—å—ë","–°–¥–µ–ª–∞–π –º–Ω–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç —Ç–∞–∫, –±—É–¥—Ç–æ —Å–æ–±–ª–∞–∑–Ω—è–µ—à—å","–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π –∏ –ø–æ–∫–∞–∂–∏ (–≤ —á–∞—Ç) —Å–≤–æ—ë —Å–∞–º–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ –º–µ—Å—Ç–æ —Ç–µ–ª–∞"];

      const list = snap.val()==='truth' ? truths : dares;
      const q = list[Math.floor(Math.random()*list.length)];
      question.set(q + (snap.val()==='dare' ? ' üòà' : ' üî•'));
      choice.set(null);
    });

    question.on('value', snap=>{
      if (snap.val()) document.getElementById('question').innerHTML = '<b>'+snap.val()+'</b><br><br>–¢–µ–ø–µ—Ä—å —Ö–æ–¥–∏—Ç –¥—Ä—É–≥–æ–π ‚ù§Ô∏è';
    });

    turn.set('X'); // —Å—Ç–∞—Ä—Ç
  </script>
</body>
</html>
